# 关于 FailoverReactor is null
```log
java.lang.NullPointerException: Cannot invoke "com.alibaba.nacos.client.naming.backups.FailoverDataSource.getSwitch()" because the return value of "com.alibaba.nacos.client.naming.backups.FailoverReactor.access$000(com.alibaba.nacos.client.naming.backups.FailoverReactor)" is null
```

## 出现这个问题的原因

在 org.springframework.beans.factory.InitializingBean.afterPropertiesSet 方法中做初始化操作，涉及到rpc（含feignClient调用）操作。但在 Spring Bean 的 afterPropertiesSet 初始化阶段访问了 Nacos 客户端相关资源（Nacos 服务发现来获取服务地址，即依赖 Nacos），但此时 Nacos 客户端尚未完成初始化，导致依赖的 FailoverReactor 等组件为 null，最终触发空指针异常。

当然，这个时候rpc也是可能成调用的，Nacos 服务发现的核心功能已临时可用，但内部故障转移（Failover）组件的初始化滞后，导致首次调用成功后，后续的故障转移检查触发空指针异常。

Nacos 客户端的 FailoverReactor（故障转移组件）属于辅助功能，其初始化异常通常发生在独立的异步线程（Nacos 内部的定时任务线程，每5秒执行一次，所以导致日志不断增长），所以并不会影响项目正常运行。


## 解决方案

我们尽量采用 @org.springframework.context.event.EventListener(org.springframework.boot.context.event.ApplicationReadyEvent.class) 做初始化操作，这样在项目启动时，web容器完全启动，Nacos 客户端已经完成初始化，不会出现空指针异常和其他一些资源依赖问题。

